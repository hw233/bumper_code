{"version":3,"sources":["FriendRankList.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["import RankListBase from './RankListBase';\r\nimport GlobalVar from './GlobalVar';\r\nimport WXHelper from './WXHelper';\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n//好友排行榜\r\n@ccclass\r\nexport default class FriendRankList extends RankListBase\r\n{\r\n     //显示排行榜\r\n    protected showRankList()\r\n    {\r\n        var self = this;\r\n\r\n        //获取用户好友的托管数据成功\r\n        var getFriendDataSuccess = function(res){\r\n            if(res && res.data){\r\n\r\n                console.log(\"获取用户好友的托管数据:\", res);\r\n\r\n                //排序\r\n                self.dataSort(res.data);\r\n\r\n                var selfIndex = -1;\r\n\r\n                for(var i = 0; i < 30; i++){ \r\n                    if(res.data.length <= i){\r\n                        break;\r\n                    }\r\n                    \r\n                    var item = cc.instantiate(self.prefabRankItem); //生成node节点\r\n                    item.parent = self.scrollViewContent;\r\n                    item.getComponent(\"RankItem\").initView(i + 1, res.data[i], GlobalVar.rankType);  \r\n                    item.y = -(i * 100);\r\n\r\n                    if(res.data[i].avatarUrl == GlobalVar.avatarUrl)\r\n                    {\r\n                        selfIndex = i;\r\n                    }\r\n                }\r\n\r\n                var selfData = self.getSelfData(res.data);\r\n                if(selfData){\r\n                    selfData.is_rank = (selfIndex != -1);\r\n                    var myitem = cc.instantiate(self.prefabRankItem); //生成node节点\r\n                    myitem.parent = self.node;\r\n                    myitem.getComponent(\"RankItem\").initView(selfIndex + 1, selfData, GlobalVar.rankType, true);  \r\n                    myitem.y = -320;\r\n                }\r\n\r\n                self.rankingScrollView.node.active = true;\r\n            }\r\n        };\r\n\r\n        if(GlobalVar.rankType == 1)\r\n        {\r\n            WXHelper.GetFriendCloudData([\"kill_num\"], getFriendDataSuccess);\r\n        }else if(GlobalVar.rankType == 2)\r\n        {\r\n            WXHelper.GetFriendCloudData([\"star_num\"], getFriendDataSuccess);\r\n        }\r\n    }\r\n\r\n    private getSelfData(data)\r\n    {\r\n        for(var i = 0; i < data.length; i++)\r\n        { \r\n            if(data[i].avatarUrl == GlobalVar.avatarUrl){\r\n                return data[i];\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    //排序(ListData：res.data)\r\n    protected dataSort(ListData){\r\n        ListData.sort(function(a, b){\r\n            var aScore = parseInt(a.KVDataList[0].value);\r\n            var bScore = parseInt(b.KVDataList[0].value);\r\n\r\n            a.score = aScore;\r\n            b.score = bScore;\r\n\r\n            return bScore - aScore;\r\n        });\r\n    }\r\n}"]}