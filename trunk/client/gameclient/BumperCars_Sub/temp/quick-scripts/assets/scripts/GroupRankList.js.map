{"version":3,"sources":["GroupRankList.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["import GlobalVar from './GlobalVar';\r\nimport WXHelper from './WXHelper';\r\nimport RankListBase from './RankListBase';\r\n\r\nconst {ccclass, property} = cc._decorator;\r\n\r\n@ccclass\r\nexport default class GroupRankList extends RankListBase\r\n{\r\n    //显示排行榜\r\n    protected showRankList(){\r\n        var self = this;\r\n\r\n        // var userData = null;\r\n\r\n        //获取群同玩用户的托管数据成功\r\n        var getGroupDataSuccess = function(res){\r\n            if(res && res.data){\r\n\r\n                console.log(\"获取群同玩用户的托管数据:\", res);\r\n\r\n                //排序\r\n                self.dataSort(res.data);\r\n\r\n                for(var i = 0; i < res.data.length; i++)\r\n                { \r\n                    var item = cc.instantiate(self.prefabRankItem); //生成node节点\r\n                    item.parent = self.scrollViewContent;\r\n                    item.getComponent(\"RankItem\").initView(i + 1, res.data[i], GlobalVar.rankType);  \r\n                    item.y = -(i * 100);\r\n\r\n                    if(res.data[i].avatarUrl == GlobalVar.avatarUrl)\r\n                    {\r\n                        var myitem = cc.instantiate(self.prefabRankItem); //生成node节点\r\n                        res.data[i].is_rank = true;\r\n                        myitem.parent = self.node;\r\n                        myitem.getComponent(\"RankItem\").initView(i + 1, res.data[i], GlobalVar.rankType, true);  \r\n                        myitem.y = -320;\r\n                    }\r\n                }\r\n\r\n                self.rankingScrollView.node.active = true;\r\n            }\r\n        };\r\n\r\n        if(GlobalVar.rankType == 1)\r\n        {\r\n            WXHelper.GetGroupCloudData([\"kill_num\"], getGroupDataSuccess);\r\n        }else if(GlobalVar.rankType == 2)\r\n        {\r\n            WXHelper.GetGroupCloudData([\"star_num\"], getGroupDataSuccess);\r\n        }\r\n    }\r\n\r\n    //排序(ListData：res.data)\r\n    protected dataSort(ListData)\r\n    {\r\n        for(var i = ListData.length - 1; i >= 0; i --){\r\n            var item  = ListData[i];\r\n            if(item){\r\n                if(item.KVDataList.length <= 0){\r\n                    ListData.splice(i, 1);\r\n                    // item.KVDataList.push({key:\"highest_score\", value: i});\r\n                }\r\n            }\r\n        }\r\n\r\n        ListData.sort(function(a, b){\r\n            var aScore = parseInt(a.KVDataList[0].value);\r\n            var bScore = parseInt(b.KVDataList[0].value);\r\n\r\n            a.score = aScore;\r\n            b.score = bScore;\r\n\r\n            return bScore - aScore;\r\n        });\r\n    }\r\n}"]}